language: ruby
dist: trusty
sudo: required
rvm:
- 2.4.1
#- 2.3.1
jdk:
  - openjdk8
#  - oraclejdk8
deploy:
  provider: heroku
  app: noltarium-blog-test
  on:
    repo: nolte/jekyll-boilerplate
    all_branches: true
  api_key:
    secure: "owiTv9tnGaKp0Wk/t/yLE4krwQsER2ivL0YILaSQUomNG8/4Kj4GN0wdcTdm+S42psXSi6xAIOeDt3q5WM/hrxHorhOSLUWClN2pIXHy+xtRcAIO/VdPQMjNB8jJsr3uFiew0OwZqA03KtNCaGRpmzIDAtTZy4rTo/DOn9fuDvv4gcBWenXxyouRNc4cLBgpW596rFFcaF0ohdaCNV5HCEDZbXfcM2/T5iMO5Om8D82Tt6/UfobwLVCBDnfIrVAtWbWmu5sCGgLQEeX/kMNrwSJsik+8tCYPcQcltf3BI3TbHAPptzOCQIUbJImK8TrCoah1J7+G0b7CqR1VHmGKkUu1cDzGd3PgnoNFgKsSW0zGEaXI7G9r6y2ZvBwKrEPaQqpbmctD9Abp/khYZiDFuUsRUfM+YA+qQgYHOjzIgPo0YBGQrPW3OUXZeLQFhW3RsN+vxz+u42Z4e+3jyYJBvd2pkzvwUKDo+RpgPqC9eMib0VewXV1CTGpPDhs9uPfDdMHX4DAJkScgbpWwolgDy0OQZI/D0DG2IfrwEyz1u2qT4BS8xqvBjmZt0UpMDpo0FRJ8KD6yddjQRwh5ZymGgUqkZ9isQIkeP8Xo2YhdwmQVMHC7qb4eMV+xtxKI6UqX6kI6enMOmpJas0kd3ErJNkRdPu3+7SfuhdmZe/Uvymk="


env:
  - PLANTUML_VERSION=1.2017.15

before_install:
  - gem install bundler
  # configure plantum dependencies
  - wget http://repo1.maven.org/maven2/net/sourceforge/plantuml/plantuml/$PLANTUML_VERSION/plantuml-$PLANTUML_VERSION.jar -O /tmp/plantuml.jar
  - echo "#!/bin/bash" > /tmp/plantuml
  - echo "java -jar /tmp/plantuml.jar \"\$1\" \"\$2\"" >> /tmp/plantuml
  - sudo mv /tmp/plantuml  /usr/bin/plantuml
  - sudo chmod u+x /usr/bin/plantuml
  - sudo apt-get -qq update
  - sudo apt-get install -y ditaa graphviz phantomjs

install:
  - bundle install

script:
  - bundle exec rake build
  - bundle exec rake html_proofer

after_success:
  # steps for heroku commit, push the generated files to container
  - git add _site -f --all
  - git add Gemfile.lock
  - git commit -m "travisBuild"

after_deploy:
  - bundle exec rake test
